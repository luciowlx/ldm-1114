# 共识文档：数据预处理-字段选择（多数据集）允许修改

## 明确需求与验收标准
- 当选择多个数据集进入字段选择步骤时：
  - 字段名可编辑（输入框启用），提供空值与重复名校验；
  - 字段类型可编辑（下拉启用）；
  - 若存在错误（空值或重复名），显示红色提示并阻止进入下一步；
  - 下一步按钮禁用条件在多源下基于 aggregatedFields 的选择与错误状态。

## 技术实现要点
- 新增状态：`aggFieldNameEditValues`、`aggFieldNameErrors`、`aggDuplicateNameSet`、`hasAnyAggNameError`；
- 启用多源表格中的 Input/Select 并绑定编辑/校验事件；
- 更新下一步按钮禁用条件：区分单源/多源；
- 同步更新清洗规则中字段引用（保持一致性）。

## 边界与限制
- 不进行真实跨源合并与冲突自动解决；
- 不新增批量重命名与类型统一工具；
- 仅前端原型行为调整。

## 集成约束
- 变更仅影响 `src/components/DataPreprocessing.tsx`，不破坏已有单源流程；
- 保持 UI 风格与现有组件一致。

## 验收用例（可测试）
1. 在 Step 0 勾选 2 个数据集，进入字段选择：Input/Select 可用；
2. 将某字段名清空：出现错误提示，下一步按钮禁用；
3. 将两个字段改为同名（忽略大小写）：出现重复提示，下一步禁用；
4. 修改字段类型为 number：类型徽标颜色变化；
5. 选择至少 1 个字段且无错误：可进入规则配置。