# 阶段1最终共识：数据合并规则（CONSENSUS - 公共字段）

## 明确的需求与验收标准
- 规则类型：`data_merge`。
- 主/从数据集与版本来源：沿用 Step2 的选择；若缺省按当前激活数据集/版本回退（该信息不在面板展示，仅用于公共字段候选与类型校验）。
- 公共字段：选择一个同时存在于主/从数据集的字段，且类型兼容（相同或 text↔category）。
- 合并方式：必须选择其一（`Inner` / `Left` / `Outer`）。
- 校验要求：
  1) 必须选择有效的公共字段；
  2) 类型不兼容或公共字段不存在于任一侧视为错误；
  3) 未选择合并方式视为错误；
  4) 任一启用的 `data_merge` 规则若不合法，需禁用“开始执行数据处理”。
- 交互说明：
  - 面板内错误提示与统一提示同时出现；
  - 禁用提交时按钮展示统一原因文案。

## 技术实现方案与约束
- 复用 `CleaningRule` 接口，扩展枚举加入 `data_merge`；
- 在 `updateCleaningRule` 初始化默认配置：主/从数据集与版本、`commonField` 与 `joinType`；
- 在规则类型下拉加入 `数据合并` 选项，且该类型隐藏单字段选择控件；
- 在 `handleApply` 的 disabled 条件中执行公共字段与合并方式的全局校验；
- 与现有架构无冲突，遵循组件风格与代码注释规范。

## 任务边界与验收
- 边界：仅前端原型演示；不做真实后端数据合并与持久化；
- 验收：在本地预览中完成三种合并方式与公共字段选择的配置与校验触发；提交按钮在有误时禁用，修正后可用；控制台无错误。

## 不确定性已解决
- 类型兼容策略与主/从来源、无公共字段时的提示与禁用已确定；其余后端相关问题在原型阶段不处理。