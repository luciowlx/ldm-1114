# 说明文档（项目全生命周期）

> 本文档用于项目规划、实施方案与进度记录的统一管理；每次启动开发前需先阅读并确认当前进度与要求。

## 一、项目规划

- 目标：构建数据管理原型，支持数据上传、数据预处理（选择数据集→字段选择→规则配置）等关键流程的前端演示。
- 范围：仅前端模拟数据，不涉及后端；需保持各步骤之间字段一致性。
- 时间：以当日迭代为单位，严格按节点推进，发现风险需及时记录并调整计划。

## 二、实施方案

- 技术栈：Mac 开发环境；React + TypeScript + Vite；组件位于 `src/components/*`；统一风格与代码注释规范。
- 流程：按六阶段（Align→Architect→Atomize→Approve→Automate→Assess）推进；测试优先、文档同步。
- 安全：敏感信息使用 `.env` 管理（当前迭代仅前端原型，无后端密钥）。

## 三、进度记录（按节点）

- 2025-12-03：启动 Web 服务
  - 变更：启动本地开发服务器，端口 3000。
  - 验收：访问 `http://localhost:3000/` 正常。

- 2025-12-03：数据预处理-字段选择新增「数据来源」列
  - 需求：在“显示全部字段”模式下，增加一列展示字段来源的文件名（或数据集/版本名）。
  - 变更：
    1) `AggregatedField` 接口新增 `sourceFiles` 字段；
    2) 聚合逻辑中计算每个字段的来源文件；
    3) 表格渲染逻辑中，当 `!showCommonOnly` 时展示“数据来源”列。
  - 文件：`src/components/DataPreprocessing.tsx`
  - 验收：在 `http://localhost:3000/` 预览，选择多个数据集/文件，进入字段选择并切换到“显示全部字段”，确认“数据来源”列显示正确。

- 2025-12-03：修复数据预处理-字段选择“数据来源”列显示问题
  - 问题：当选择同一数据集下的多个文件/版本时，未正确进入聚合视图，导致“数据来源”列不显示。
  - 修复：将表格渲染和“下一步”按钮的判断条件从 `selectedDatasetIds.length > 1` 修改为 `selectedSourcesForView.length > 1`。
  - 文件：`src/components/DataPreprocessing.tsx`
  - 验收：选择同一数据集的多个文件，确认能看到聚合视图及“数据来源”列。

- 2025-12-03：优化数据预处理-字段选择“数据来源”列显示
  - 需求：明确数据来源为具体文件，避免仅显示数据集名称造成混淆。
  - 变更：
    1) 优先显示文件名；
    2) 若未指定文件（仅选择版本），显示“数据集名称 (版本号)”，以明确来源层级。
  - 文件：`src/components/DataPreprocessing.tsx`
  - 验收：在“数据来源”列中，文件来源显示具体文件名，版本来源显示带版本号的名称。

- 2025-12-03：移除数据预处理-字段选择界面的冗余提示文字
  - 需求：移除“已选择多个来源（数据集/版本/文件），以下展示公共字段聚合视图。”这段文字。
  - 变更：删除 `src/components/DataPreprocessing.tsx` 中的对应 `<span>` 元素。
  - 验收：界面不再显示该提示文字。

- 2025-12-03：优化数据预处理-字段选择“数据来源”列显示逻辑
  - 需求：数据来源每一行只保留随机一个文件名称，代表这一行数据来源于一个文件。
  - 变更：修改 `src/components/DataPreprocessing.tsx` 中的聚合逻辑，从所有来源中随机选择一个进行展示。
  - 验收：在“数据来源”列中，每行仅显示一个文件名（或版本名）。

- 2025-12-03：数据预处理-字段选择增加检索与筛选功能
  - 需求：字段名增加模糊搜索，数据来源增加文件多选筛选。
  - 变更：
    1) 在表头增加搜索图标与输入框（字段名）及筛选图标与下拉复选框（数据来源）；
    2) 实现前端过滤逻辑，支持字段名模糊匹配与数据来源多选匹配。
  - 文件：`src/components/DataPreprocessing.tsx`
  - 验收：
    1) 点击字段名旁的搜索图标，输入关键词，表格行应实时过滤；
    2) 点击数据来源旁的筛选图标，勾选文件，表格应仅显示包含该来源的行。

- 2025-11-14：系统管理接入任务引擎；导航回退
  - 变更：
    1) 在“系统管理”左侧子菜单新增“任务引擎”，右侧集成任务模板管理与三分栏编辑器（沿用 HtmlConfigManagement 页面作为模板管理与编辑器展示）。
    2) 顶部导航移除“配置管理”一级菜单，保留“系统管理”下的数据字典与任务引擎作为子功能入口。
    3) 右上角版本标识更新为 `v1.0`，与当前能力对齐。
  - 文件：`src/components/SystemManagement.tsx`、`src/components/HtmlConfigManagement.tsx`、`src/components/Header.tsx`、`src/App.tsx`。
  - 推送：`main` 分支已推送到远端 `git@github.com:luciowlx/ldm-mvp.git`（最新提交 `e9f8a1e`）。
  - 验收：在 `http://localhost:3000/` 预览，“系统管理 → 任务引擎”展示任务模板管理，顶部导航不含“配置管理”，头像菜单显示版本号；构建与运行无报错。
- 2025-11-11：数据上传弹窗 UI 精简
  - 变更：删除顶部对话框描述文字与拖拽区域相同说明文字，简化界面。
  - 文件：`src/components/DataUpload.tsx`
  - 验收：在 `http://localhost:3000/` 预览，交互正常无报错。

- 2025-11-11：数据预处理-字段选择（多数据集）允许修改
  - 需求：当步骤一选择多个数据集时，字段选择步骤展示的聚合字段允许修改（至少字段名与类型）。
  - 变更：在 `src/components/DataPreprocessing.tsx` 新增多源编辑态与校验状态（`aggFieldNameEditValues/Errors`、`aggDuplicateNameSet/hasAnyAggNameError`），启用 Input/Select 控件，完善校验与下一步按钮禁用逻辑；保持 UI 与单源一致。
  - 验收要点：
    1) 多源场景下 Input/Select 可用；
    2) 空值与重复名有行内提示并阻断下一步；
    3) 类型修改正常；
    4) 至少勾选 1 个字段且无错误时可进入规则配置；
    5) 预览在 `http://localhost:3000/` 通过，无控制台错误。
  - 文档：新增 `docs/字段选择可修改/*`（ALIGNMENT/CONSENSUS/DESIGN/TASK/ACCEPTANCE）。

- 2025-11-11：数据预处理-规则配置新增「数据合并」
  - 需求：支持在清洗规则中新增 `data_merge` 类型；主/从数据集与版本只读展示；多行字段映射；合并方式必选（Inner/Left/Outer）；类型兼容与重复校验；任一启用的合并规则不合法时禁用「开始执行数据处理」。
  - 变更：
    1) 扩展 `CleaningRule` 的 `type` 枚举与 `updateCleaningRule` 初始化默认配置；
    2) 规则类型下拉新增「数据合并」，并隐藏单字段选择控件；
    3) 新增合并面板 UI（主/从只读、多行映射增删与行内错误、合并方式选择、统一提示）；
    4) 在提交按钮的 `disabled` 条件中增加对启用 `data_merge` 规则的合法性校验。
  - 文件：`src/components/DataPreprocessing.tsx`
  - 验收要点：
    1) 映射为空/重复/类型不兼容/未选合并方式 → 按钮禁用且提示；
    2) 修正后按钮可用；
    3) 三种合并方式选择均正常；
    4) 控制台无错误。
  - 文档：新增 `docs/数据合并规则/*`（ALIGNMENT/CONSENSUS/DESIGN/TASK/ACCEPTANCE）。

- 2025-11-11：数据预处理-数据合并改造为「公共字段选择」
  - 需求变更：将原“多行主/从字段映射”改为“单一公共字段”下拉选择；候选项为主/从字段名交集，且类型兼容（相同或 文本↔分类）。合并方式仍必选。
  - 变更：
    1) 更新 `CleaningRule` 的配置为 `{ commonField, joinType }`，移除 `mappings`；
    2) 改造 UI：只保留公共字段下拉与合并方式选择；当无公共字段时提示并禁用；
    3) 更新全局提交禁用逻辑：未选择有效公共字段或未选合并方式时禁用；
    4) 更新面板“校验规则”文案为公共字段说明与缺失处理策略。
  - 文件：`src/components/DataPreprocessing.tsx`
  - 验收要点：
    1) 公共字段必须存在于主/从两侧且类型兼容；
    2) 三种合并方式选择均正常；
    3) 无公共字段时展示提示并禁用提交；
    4) 控制台无错误；本地预览地址 `http://localhost:3000/`。
  - 文档：已同步更新 `docs/数据合并规则/*`（ALIGNMENT/CONSENSUS/DESIGN/TASK/ACCEPTANCE）。

- 2025-11-12：角色权限配置弹窗重构并推送至远程分支
  - 变更：
    1) 权限配置弹窗由上下布局改为左右双栏（左侧一级菜单导航，右侧二级模块与三级按钮）；
    2) 将「数据集管理」「数据预处理」合并为一级菜单「数据管理」，两者作为二级模块；
    3) 完整级联选择逻辑：一级菜单全选/取消、二级模块全选/取消、三级按钮独立选择；计数实时更新；
    4) 交互优化：右侧“当前菜单全选”开关、滚动区域、底部固定保存/取消按钮。
  - 文件：`src/components/RoleManagement.tsx`
  - 推送：本地分支 `feature/i18n-data-upload` 已推送到远程 `origin/i18n-data-upload`，设置为跟踪分支；PR链接（如需）可参考 Git 输出：`https://github.com/luciowlx/ldm-mvp/pull/new/i18n-data-upload`。
  - 验收：在 `http://localhost:3000/` 或 `http://localhost:3001/` 预览，左右双栏与级联选择均正常，无控制台错误。

- 2025-11-13：同步推送到新远程仓库 ldm-new（i18n-data-upload 分支）
  - 操作：新增远程 `ldm-new` 指向 `https://github.com/luciowlx/ldm-new.git`，并将本地分支 `feature/i18n-data-upload` 推送为远程分支 `i18n-data-upload`，同时设为上游分支。
  - 目的：在新仓库进行并行维护与评审，便于后续 PR 流程与版本对齐。
  - 记录：Git 输出显示推送成功，分支已建立跟踪关系。

- 2025-11-13：数据详情预览-数据切换查看 原型
  - 需求：在数据详情页的“数据表预览”加入多子数据集切换（主文件/文件-2/文件-3），用于单次上传包含多个文件场景的演示；切换需联动表格渲染与统计。
  - 变更：
    1) 在 `DataDetailFullPage.tsx` 新增 `activeSubDatasetId`、`previewRows` 状态与 `subDatasetRows` 映射；
    2) 表头加入切换 Chips（主文件/文件-2/文件-3）；
    3) 将统计和过滤函数的输入改造为 `previewRows`（`calcColumnStats`/`getUniqueValueRatioPercent`/`getFilteredData`/`getMissingAnalysisMock`）；
    4) 「共计 N 行」与 Tooltip 总数改为随 `previewRows.length` 动态更新；
    5) 新增函数注释（JSDoc）满足代码输出标准。
  - 文件：`src/components/DataDetailFullPage.tsx`
  - 文档：新增 `docs/数据详情预览数据切换/ALIGNMENT_*.md`、`DESIGN_*.md`、`TASK_*.md`
  - 验收：在 `http://localhost:3002/` 预览，切换控件正常、总记录数与列标签联动更新、过滤功能在不同子集下工作正常、控制台无报错。

- 2025-11-13：数据详情预览-统计与子集选择优化
  - 需求：
    1) 在顶部“统计信息”增加「文件数量」字段，展示下方“数据子集”的数量；
    2) 数据子集选择控件由 Chips 改为下拉选项，选项展示完整的数据名称。
  - 变更：
    1) 基本信息区域新增「文件数量」字段（取值为下方数据子集数量）；
    2) 统计信息卡片同步新增「文件数量」（以 `subDatasetOptions.length` 计算）；
    3) 将子集切换组件替换为 `Select` 下拉，`SelectItem` 展示完整名称（示例：主文件（示例主表.csv）、客户信息（示例-文件-2.csv）、交易记录（示例-文件-3.csv））；
    4) 保持原有 `handleSwitchSubDataset` 逻辑，联动 `previewRows` 与总记录数；
    5) 代码注释同步完善（函数级注释已在前序任务添加）。
  - 追加改造：
    - 数据表预览卡片头部的左侧计数文案由“共计 N 行”改为“总条数 N | 总字段数 M”，其中 N 取自当前预览行数，M 取自当前字段总数，便于直观了解样本与列规模。
  - 文件：`src/components/DataDetailFullPage.tsx`
  - 验收：在 `http://localhost:3002/` 预览，顶部统计出现第三项「文件数量」且取值为 3；下拉选择可正确切换子集，表格与统计随之更新；控制台无报错。

- 2025-11-13：数据详情页-移除统计信息模块
  - 需求：按用户要求，去掉页面右侧的「统计信息」区块。
  - 变更：删除统计信息卡片的渲染代码；将顶部卡片的栅格从 `grid-cols-1 lg:grid-cols-2` 改为 `grid-cols-1`，使左侧「基本信息」占满宽度；不影响下方数据表预览与子集切换。
  - 文件：`src/components/DataDetailFullPage.tsx`
  - 验收：在 `http://localhost:3000/` 预览，统计信息不再显示，页面布局正常，控制台无报错。

- 2025-11-13：数据集列表-去掉“列数”列
  - 需求：列表页移除“列数”列，只保留名称/大小/行数/来源/版本/更新时间等。
  - 变更：将 `DataManagement.tsx` 的 `columnSettings.columns` 默认值改为 `false`，使“列数”列不再显示（仍可通过“列表列设置”弹窗恢复，若后续需要）。
  - 文件：`src/components/DataManagement.tsx`
  - 验收：在 `http://localhost:3000/` 预览，数据集列表不再显示“列数”列，页面无报错。

- 2025-11-13：数据集列表-列含义调整（版本→数据版本数量，大小→文件数量）
  - 需求：将数据列中的“版本”改为“数据版本数量”，将“大小”改为“文件数量”。
  - 变更：
    1) 在 `Dataset` 接口与模拟数据中新增 `versionCount` 与 `fileCount` 字段；
    2) 列表列定义中将 `version` 列的标签与渲染改为展示 `versionCount`；
    3) 将 `size` 列的标签改为“文件数量”，并渲染 `fileCount`；
    4) 排序逻辑中将按 `size` 的排序改为按 `fileCount` 排序（即文件数量）。
  - 文件：`src/components/DataManagement.tsx`
  - 验收：在 `http://localhost:3000/` 预览，“版本”列显示为“数据版本数量”且值为数值；“大小”列显示为“文件数量”且可按数量排序；控制台无报错。

- 2025-11-13：数据集标签替换为业务字段
  
- 2025-11-13：数据列表-格式支持多值样式
  - 需求背景：一个数据集可能包含多种文件格式，需要在列表与卡片中直观看到所有格式，并支持按多格式筛选。
  - 变更内容：将 `Dataset` 的 `format` 单值字段改为 `formats` 数组；更新“格式”列与顶部卡片显示为“CSV · Parquet · JSONL（3）”样式；筛选支持勾选多个格式并匹配任一命中。
  - 涉及文件：`src/components/DataManagement.tsx`
  - 验收方式：运行本地预览，进入“数据管理”，在数据集列表与顶部卡片中看到“格式：CSV · Parquet · JSONL（3）”；表头 Popover 的“格式”筛选可多选并正确过滤；页面无错误日志。

- 2025-11-13：格式文本样式与交互优化
  - 需求背景：用户要求“不要蓝色字，黑色字体，hover时展示更多格式”。
  - 变更内容：将“格式”展示文本的颜色从蓝色调整为黑色；为列表与卡片中的“格式”文本增加原生 `title` 提示，鼠标悬停显示完整格式列表。
  - 涉及文件：`src/components/DataManagement.tsx`
  - 验收方式：在“数据管理”页面，列表和顶部卡片的格式文本为黑色；鼠标悬停在格式文本上显示“全部格式：CSV · Parquet · JSONL”等完整列表；页面无错误日志。
  - 需求：将原先技术性标签（CSV/JSON/已清洗/实时/需清洗）替换为业务字段标签（如客户数据、交易数据、供应商数据、库存数据），以贴合业务语义。
  - 变更：更新 `DataManagement.tsx` 模拟数据中各数据集的 `tags` 内容：
    - 销售数据集 → 交易数据、客户数据
    - 用户行为数据 → 客户数据、交易数据
    - 产品库存数据 → 供应商数据、库存数据
同时，标签筛选的可选项自动依据 `datasets.tags` 动态生成，无需额外改造。
  - 文件：`src/components/DataManagement.tsx`
  - 验收：在 `http://localhost:3000/` 预览，列表与卡片中的灰色标签显示为业务字段；标签筛选面板出现新的业务标签并可正常筛选；控制台无报错。

## 四、风险与后续计划

- 风险：未来若引入后端需定义跨源字段名/类型的持久化与冲突解决策略。
- 下一步建议：
  - 在规则配置（Step 2）中同步展示用户修改后的聚合字段名与类型，确保一致；
  - 增加批量重命名或类型统一的便捷操作（原型阶段可暂缓）。

---

### 2025-11-13｜数据预处理表格字段显示异常修复

- 问题背景：数据管理页“预处理任务管理”表格中，“创建人”表头显示为原始键 `data.preprocessing.table.creator`，属于 i18n 缺失导致的回退展示。
- 变更内容：在 `src/i18n/LanguageContext.tsx` 中补充中英文文案键：
  - `zh`: `data.preprocessing.table.creator` → “创建人”
  - `en`: `data.preprocessing.table.creator` → “Creator”
- 涉及文件：
  - `src/i18n/LanguageContext.tsx`
  - 展示位置：`src/components/DataManagement.tsx` 预处理任务表格表头使用 `t('data.preprocessing.table.creator')`
- 验收方式：
  1) 启动本地服务并打开 `http://localhost:3001/`；
  2) 进入“数据管理”→“预处理任务管理”；
  3) 确认表格表头显示为“创建人”（英文环境为“Creator”），不再出现原始键；
  4) 页面无报错，交互正常。

### 2025-11-13｜i18n 重复键错误修复

- 问题背景：IDE 报错“对象文本不能具有多个名称相同的属性”，定位到 `src/i18n/LanguageContext.tsx` 英文语言包中存在重复键：
  - `"data.upload.toast.sizeLimitDesc"` 同时被定义为 “Single file must not exceed 100MB” 与 “Max file size is 1GB”。
- 变更内容：移除后者的重复键，仅保留单文件 100MB 的提示文案；批量上传总大小限制由 `"data.upload.toast.batchLimitDesc"` 单独覆盖，不与单文件限制冲突。
- 涉及文件：
  - `src/i18n/LanguageContext.tsx`（英文语言包片段）。
- 验收方式：
  1) 保存后检查 Problems 面板与 TypeScript 编译是否仍有重复属性错误；
  2) 在数据上传相关页面触发上传提示，确认英文提示语保持为单文件 100MB；
  3) 其他 i18n 行为未受影响。

### 2025-11-13｜数据管理卡片：将网格“列数”改为“版本数量”

- 需求背景：卡片信息区的“列数: 18”希望替换为“版本数量: N”，与列表列含义调整保持一致。
- 变更内容：
  1) 在 i18n 中新增键 `data.grid.versionCount`（中：版本数量:；英：Version Count:）；
  2) 将 `src/components/DataManagement.tsx` 卡片信息网格的最后一项从 `data.grid.columns` + `dataset.columns` 改为 `data.grid.versionCount` + `dataset.versionCount`。
- 涉及文件：
  - `src/i18n/LanguageContext.tsx`
  - `src/components/DataManagement.tsx`
- 验收方式：
  1) 在 `http://localhost:3000/` 预览数据管理页；
  2) 卡片信息区显示“版本数量: X”，取值来自模拟数据 `versionCount`；
  3) 页面无错误日志。

### 2025-11-13｜数据管理卡片：将“完整度”改为“上传进度”

- 需求背景：卡片信息区原显示“完整度”，演示更贴近上传场景，改为“上传进度”。
- 变更内容：
  1) 卡片网格进度标签由 `data.grid.completeness` 改为 `data.upload.progress`；
  2) 进度数值按数据集状态映射：成功=100%、导入中=88%、失败=0%。
- 涉及文件：
  - `src/components/DataManagement.tsx`

### 2025-11-13｜数据详情页移除“复制ID”与“版本号”展示

- 需求：按用户要求，去掉页面红框中的内容（顶部与基本信息内的“复制ID”按钮，以及“版本号 vX.Y”的静态展示）。
- 变更：
  1) 删除顶部导航中“复制ID”按钮；
  2) 删除基本信息网格中的“复制ID”按钮与复制提示；
  3) 删除基本信息网格中的“版本号”字段展示；
  4) 移除相关 `Copy` 图标与 `copyTip` 状态、`handleCopyId` 方法。
- 涉及文件：`src/components/DataDetailFullPage.tsx`
- 验收：在 `http://localhost:3000/#data-detail?id=1&tab=overview` 预览，页面不再显示“复制ID”按钮与“版本号”，控制台无报错。

### 2025-11-13｜数据详情页移除“数据名称”字段，并绑定列表名称

- 需求：去掉基本信息卡片中的“数据名称”字段；顶部标题显示进入路径的列表数据名称（例如从“销售数据集”进入，顶部显示“销售数据集”）。
- 变更：
  1) 基本信息区移除“数据名称”行，仅保留“数据ID”；
  2) 初始化元数据 `initialMeta` 时使用 `dataset.title`、`dataset.id`、`dataset.version`、`dataset.description`；
  3) 顶部标题继续读取 `meta.name`，现值来源于列表数据集名称。
- 涉及文件：`src/components/DataDetailFullPage.tsx`
- 验收：在 `http://localhost:3000/#data-detail?id=1&tab=overview` 预览，基本信息不再显示“数据名称”；顶部标题显示为列表数据集名称；控制台无报错。
- 验收方式：
  1) 在 `http://localhost:3000/` 预览数据管理页；
  2) 成功数据集显示“上传进度：100%”，导入中显示“上传进度：88%”，失败显示“上传进度：0%”；
  3) 进度条与百分比一致，页面无错误日志。

### 2025-11-13｜数据管理卡片：将“格式”改为“文件数量”，并调整显示顺序

- 需求背景：卡片信息网格目前展示“格式: CSV · Parquet · JSONL（3）”，需替换为“文件数量”，并重排四项为“版本数量、文件数量、大小、行数”。
- 变更内容：
  1) 删除“格式”展示，新增“文件数量”展示；
  2) 网格项顺序调整为：版本数量 → 文件数量 → 大小 → 行数；
  3) 新增 i18n 键：`data.grid.fileCount`（中文：文件数量:；英文：File Count:）。
- 取值来源：
  - 版本数量：`dataset.versionCount ?? 0`
  - 文件数量：`dataset.fileCount ?? 0`
  - 大小：`dataset.size`
  - 行数：`dataset.rows`
- 涉及文件：
  - `src/components/DataManagement.tsx`
  - `src/i18n/LanguageContext.tsx`
- 验收方式：
  1) 在 `http://localhost:3000/` 预览“数据管理”页面；
  2) 卡片信息网格显示四项顺序为“版本数量、文件数量、大小、行数”；
  3) “文件数量”展示为 `dataset.fileCount` 的数值，空值显示 0；
  4) 页面与终端无新增错误日志。

### 2025-11-13｜数据详情页：下载与日志按钮位置调整

- 需求：将“下载当前版本”“查看失败日志”“下载失败日志”三个按钮，移动到“缺失分析可视化”按钮之后，强调这些操作只针对当前预览的数据版本执行。
- 变更：
  1) 从“基本信息”卡片头部移除上述三个按钮；
  2) 在“数据表预览”卡片的工具栏中，将其置于“缺失分析可视化”按钮之后；
  3) 保持原有可用性逻辑：仅当 `meta.status === "失败"` 时显示失败日志相关按钮；下载按钮受 `meta.permissions.canDownload` 控制。

### 2025-11-13｜数据详情页：工具栏第二行布局优化

- 需求：为避免与筛选控件重叠，将“查看失败日志/下载失败日志/下载当前版本”移动到工具栏第二行；在窄屏下自动换行保持可读性。
- 变更：
  1) 在 `src/components/DataDetailFullPage.tsx` 中，为工具栏新增第二行容器：`<div className="mt-3 flex items-center gap-2 flex-wrap">`；
  2) 第一行保留筛选与视图切换控件；第二行承载操作按钮；
  3) 保持按钮可用性逻辑不变：失败日志按钮仅在 `meta.status === "失败"` 时显示；下载按钮受 `canDownload` 控制且禁用态加 `opacity-50 cursor-not-allowed`。
- 验收方式：
  - 在 `http://localhost:3000/#data-detail?id=1&tab=overview` 预览；
  - 不同屏宽下，第一行与第二行无重叠，自动换行；功能与状态逻辑与之前一致；
  - 控制台与终端无新增错误。
- 涉及文件：`src/components/DataDetailFullPage.tsx`
- 验收：在 `http://localhost:3000/#data-detail?id=1&tab=overview` 预览，三个操作按钮位于“缺失分析可视化”按钮之后；点击交互与失败日志弹窗正常；控制台无报错。

### 2025-11-13｜历史版本页布局调整（右上角去除 + 列表迁移）

- 需求：历史版本页中，移除版本树右上角红框内容；将版本列表展示在该右上区域；同时去掉页面底部的大版本列表，仅保留顶部搜索栏。
- 变更：
  1) 在 `src/components/VersionHistory.tsx` 的「版本树」右侧区域，渲染精简版“版本列表”（支持选择两项进行对比、按版本号排序、来源筛选、状态徽标、规则摘要、回退与切换查看）；
  2) 移除原底部“版本列表”表格，仅保留搜索输入的筛选工具栏；
  3) 右上角原文本描述块删除，确保视觉上“左图右表”的双栏布局；
  4) “切换查看”调用数据详情页的 `handleSwitchVersion`，保持各页面数据一致性（版本号/来源/创建时间/创建人/大小/状态/描述等）。
- 涉及文件：`src/components/VersionHistory.tsx`、`src/components/DataDetailFullPage.tsx`
- 验收方式：

  1) 启动本地服务并打开 `http://localhost:3000/#data-detail?id=1&tab=versions`；
  2) 右上角显示为“版本列表”，原红框文本块不再出现；页面底部不再有大列表；
  3) 勾选两行后“版本对比”按钮可用；点击“切换查看”后返回“数据概览及变量”，顶部基础信息随版本联动；
  4) 控制台无报错，交互正常。

### 2025-11-13｜版本树左右占比优化（30%/70%）与去除来源方式列

- 需求：优化版本树与列表的左右占比为 30% / 70%，确保右侧列表完整展示；同时移除右侧列表中的“来源方式”字段。
- 变更：
  1) 在 `src/components/VersionHistory.tsx` 中，将版本树与列表的栅格从 `lg:grid-cols-2` 调整为 `lg:grid-cols-[30%_70%]`；
  2) 移除右侧“版本列表”的“来源方式”列（包含表头及数据单元格）；
  3) 保留其他列（版本号、创建时间、创建人、数据大小、状态、规则摘要、操作），版本号与创建时间支持排序；状态列保留筛选；
  4) 不涉及后端逻辑，均为前端原型展示与交互一致性优化。
- 涉及文件：`src/components/VersionHistory.tsx`
- 验收方式：
  1) 访问 `http://localhost:3000/#data-detail?id=1&tab=versions`；
  2) 左侧版本树区域宽度约占 30%，右侧列表约占 70%，列表内容完整可见；
  3) 右侧列表中不再显示“来源方式”列；点击排序与状态筛选均正常；
  4) 控制台无报错，页面交互与版本切换正常。
